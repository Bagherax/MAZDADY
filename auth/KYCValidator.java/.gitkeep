package mazdady.auth;

import android.net.Uri;
import java.util.concurrent.CompletableFuture;

public class KYCValidator {
    private String userId;
    private String phoneNumber;
    private boolean isPhoneVerified = false;
    private boolean isDocumentUploaded = false;

    public KYCValidator(String userId) {
        this.userId = userId;
    }

    public void setPhoneNumber(String phone) {
        this.phoneNumber = phone;
    }

    public CompletableFuture<Boolean> verifyPhoneNumber(String code) {
        return CompletableFuture.supplyAsync(() -> {
            boolean isValid = code.equals("123456");
            if (isValid) isPhoneVerified = true;
            return isValid;
        });
    }

    public CompletableFuture<Boolean> uploadDocument(Uri documentUri) {
        return CompletableFuture.supplyAsync(() -> {
            try {
                byte[] encryptedDoc = encryptDocument(documentUri);
                boolean uploaded = uploadToSecureStorage(encryptedDoc, userId);
                if (uploaded) {
                    isDocumentUploaded = true;
                    broadcastKYCStatus(true);
                }
                return uploaded;
            } catch (Exception e) {
                return false;
            }
        });
    }

    public boolean isFullyVerified() {
        return isPhoneVerified && isDocumentUploaded;
    }

    private byte[] encryptDocument(Uri uri) {
        return new byte[0];
    }

    private boolean uploadToSecureStorage(byte[] data, String userId) {
        return true;
    }

    private void broadcastKYCStatus(boolean verified) {
    }
}