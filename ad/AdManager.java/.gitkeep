package mazdady.ad;

import mazdady.user.UserManager;
import mazdady.wallet.WalletManager;

public class AdManager {
    private static AdManager instance;
    private AdPerformanceTracker tracker;

    private AdManager() {
        this.tracker = new AdPerformanceTracker();
    }

    public static synchronized AdManager getInstance() {
        if (instance == null) {
            instance = new AdManager();
        }
        return instance;
    }

    public boolean createCampaign(String platform, String contentUrl, 
                                 String goal, int targetCount, double budget) {
        // 1. التحقق من الرصيد
        WalletManager wallet = new WalletManager();
        if (wallet.getBalance() < budget) {
            return false;
        }

        // 2. خصم الميزانية
        wallet.withdrawMAZDADY(budget); // في الإنتاج: استخدام طريقة خاصة للإعلانات

        // 3. إنشاء الحملة
        String userId = UserManager.getInstance(null).getCurrentUser().getUserId();
        AdCampaign campaign = new AdCampaign(userId, platform, contentUrl, goal, targetCount, budget);

        // 4. بدء تتبع الأداء
        tracker.startTracking(campaign);

        return true;
    }

    public AdPerformanceTracker getTracker() {
        return tracker;
    }
}