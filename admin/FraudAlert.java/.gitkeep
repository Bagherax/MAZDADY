package mazdady.admin;

import mazdady.user.User;

import java.time.Instant;
import java.util.concurrent.CompletableFuture;

/**
 * نظام تنبيهات الاحتيال مع دعم الكشف التلقائي
 * يتبع نمط Observer لإعلام فريق الأمن
 */
public final class FraudAlert {
    private static final FraudAlert INSTANCE = new FraudAlert();

    private FraudAlert() {}

    public static FraudAlert getInstance() {
        return INSTANCE;
    }

    public CompletableFuture<Void> triggerFraudAlertAsync(String userId, String reason) {
        return CompletableFuture.runAsync(() -> {
            System.out.println("🚨 FRAUD ALERT: " + reason + " for user " + userId + " at " + Instant.now());
            investigateUser(userId);
        });
    }

    private void investigateUser(String userId) {
        // في الإنتاج: بدء عملية التحقيق التلقائية
        System.out.println("INVESTIGATING: User " + userId + " under fraud investigation");
    }

    public void banUserForFraud(String userId) {
        AccountFreezer.getInstance().freezeAccountAsync(userId, "Fraud detected");
        System.out.println("BANNED: User " + userId + " banned for fraud");
    }
}