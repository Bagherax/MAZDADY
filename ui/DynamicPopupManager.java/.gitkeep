package mazdady.ui;

import android.app.Dialog;
import android.content.Context;
import android.graphics.Color;
import android.view.ViewGroup;
import android.widget.ScrollView;
import android.widget.TextView;
import mazdady.admin.AdminConfig;

public class DynamicPopupManager {
    private final Context context;
    private final AdminConfig.UIConfig uiConfig;

    public DynamicPopupManager(Context context) {
        this.context = context;
        this.uiConfig = AdminConfig.getInstance().getUIConfig();
    }

    public void showScrollablePopup(String title, String content) {
        Dialog dialog = new Dialog(context);
        dialog.setContentView(R.layout.dynamic_popup_layout); // سيتم إنشاؤه لاحقًا

        // تخصيص الخلفية
        ViewGroup root = dialog.findViewById(R.id.popup_root);
        root.setBackgroundColor(Color.parseColor(uiConfig.getPopupBackgroundColor()));

        // تخصيص العنوان
        TextView titleView = dialog.findViewById(R.id.popup_title);
        titleView.setText(title);
        titleView.setTextColor(Color.parseColor(uiConfig.getPopupTitleColor()));
        titleView.setTextSize(uiConfig.getPopupTitleSize());

        // تخصيص المحتوى (قابل للتمرير)
        ScrollView scrollView = dialog.findViewById(R.id.popup_scroll);
        TextView contentView = new TextView(context);
        contentView.setText(content);
        contentView.setTextColor(Color.parseColor(uiConfig.getPopupContentColor()));
        contentView.setTextSize(uiConfig.getPopupContentSize());
        contentView.setPadding(20, 20, 20, 20);
        scrollView.addView(contentView);

        // تخصيص زر الإغلاق
        TextView closeButton = dialog.findViewById(R.id.popup_close);
        closeButton.setTextColor(Color.parseColor(uiConfig.getPopupButtonColor()));
        closeButton.setTextSize(uiConfig.getPopupButtonSize());
        closeButton.setOnClickListener(v -> dialog.dismiss());

        // تخصيص الحجم
        int width = (int) (context.getResources().getDisplayMetrics().widthPixels * uiConfig.getPopupWidthRatio());
        int height = (int) (context.getResources().getDisplayMetrics().heightPixels * uiConfig.getPopupHeightRatio());
        dialog.getWindow().setLayout(width, height);

        dialog.show();
    }
}