package mazdady.ui;

import android.widget.TextView;
import android.graphics.Color;

public class PriceTickerView {
    private TextView priceView;
    private double lastPrice = 100.0;

    public PriceTickerView(TextView priceView) {
        this.priceView = priceView;
    }

    public void updatePrice(double newPrice) {
        double change = ((newPrice - lastPrice) / lastPrice) * 100;
        String symbol = change >= 0 ? "ðŸ”º" : "ðŸ”»";
        String formattedChange = String.format("%.2f", Math.abs(change));
        String display = symbol + " " + formattedChange + "%";

        // ØªØºÙŠÙŠØ± Ø§Ù„Ù„ÙˆÙ† Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§
        int color = change >= 0 ? Color.parseColor("#4CAF50") : Color.parseColor("#F44336");
        priceView.setTextColor(color);
        priceView.setText(display);

        // ØªØ£Ø«ÙŠØ± Ø§Ù‡ØªØ²Ø§Ø² Ø®ÙÙŠÙ Ø¹Ù†Ø¯ Ø§Ù„ØªØºÙŠÙŠØ± Ø§Ù„ÙƒØ¨ÙŠØ±
        if (Math.abs(change) > 5.0) {
            animatePulse();
        }

        lastPrice = newPrice;
    }

    private void animatePulse() {
        // ØªØ£Ø«ÙŠØ± Ø¨ØµØ±ÙŠ Ø¨Ø³ÙŠØ· (ÙŠÙ…ÙƒÙ† ØªØ­Ø³ÙŠÙ†Ù‡ Ù„Ø§Ø­Ù‚Ù‹Ø§)
        priceView.animate().scaleX(1.1f).scaleY(1.1f).setDuration(100)
                .withEndAction(() -> priceView.animate().scaleX(1.0f).scaleY(1.0f).setDuration(100));
    }
}